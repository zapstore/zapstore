appId: dev.zapstore.app
---
# =============================================================
# Sub-flow: Search for an app and open its detail page
#
# Env vars:
#   APP_SEARCH_TERM  - Text to type in the search field
#   APP_MATCH_TEXT   - Regex to match the search result card
#                      (use ".*partial text.*" for multi-line)
#
# After completion, the app detail page is visible.
# =============================================================

# Dismiss Samsung keyboard stylus onboarding popup if shown
- runFlow:
    when:
      visible: "Try out your stylus"
    commands:
      - tapOn: "Cancel"

# If tab bar is available, navigate to Search tab.
# When Samsung keyboard overlay is active, this label may be unavailable.
- runFlow:
    when:
      visible:
        text: ".*Tab 1 of 3"
    commands:
      - tapOn:
          text: ".*Tab 1 of 3"
          label: "Tap Search tab"

# Clear any previous search state
- runFlow:
    when:
      visible: "Clear search"
    commands:
      - tapOn: "Clear search"

- tapOn:
    text: "(?:Search apps|${APP_SEARCH_TERM})"
- runFlow:
    when:
      visible: "Try out your stylus"
    commands:
      - tapOn: "Cancel"
- inputText: "${APP_SEARCH_TERM}"
- pressKey: Enter

- assertVisible:
    text: "${APP_MATCH_TEXT}"

- tapOn:
    text: "${APP_MATCH_TEXT}"
    below:
      text: "(?:Search apps|${APP_SEARCH_TERM})"
    label: "Tap search result"
